---
title: 3-4.多环境开发独立配置文件书写技巧
createTime: 2025/06/23 14:13:01
permalink: /notes/HMSpringBoot/ehv8wlom/
---
作为程序员，在进行配置管理时，经常会遇到配置集中化和分散化的选择。一开始，所有的配置都写在一起，但为了方便维护，后续会进行拆分。多环境开发也是如此，下面介绍如何基于多环境开发进行配置的独立管理，务必掌握。

## **1. 准备工作**

将所有配置根据功能拆分成独立的配置文件，并按照以下规则命名：

*   `application-devDB.yml`
*   `application-devRedis.yml`
*   `application-devMVC.yml`

这种命名方式清晰地表明了配置文件的用途和所属环境。

## **2. 使用 include 属性**

可以使用 `include` 属性在激活指定环境的情况下，同时加载多个环境的配置，使它们生效。多个环境之间使用逗号分隔。

```yaml
spring:
  profiles:
    active: dev
    include: devDB,devRedis,devMVC
```

以上配置相当于在加载 `dev` 环境配置的同时，额外加载 `devDB`、`devRedis` 和 `devMVC` 这三组配置。这种结构使得配置更加清晰，易于理解各个环境的具体配置内容。

::: caution

当主环境（如 `dev`）与其他环境有相同属性时，主环境的属性生效；如果其他被包含的环境之间存在相同属性，则最后加载的环境的属性生效。

:::

## **3. 使用 group 属性进行改良**

上面的配置方式存在一个问题：如果要将环境从 `dev` 切换到 `pro`，`include` 属性也需要修改。因为 `include` 属性只能使用一次，这会带来不便。从 Spring Boot 2.4 版本开始，可以使用 `group` 属性替代 `include` 属性，以减少配置的书写量。简单来说，就是预先定义好不同环境对应的配置组，然后根据需要选择使用哪个组。

```yaml
spring:
  profiles:
    active: dev
    group:
      "dev": devDB,devRedis,devMVC
      "pro": proDB,proRedis,proMVC
      "test": testDB,testRedis,testMVC
```

现在，如果要将环境从 `dev` 切换到 `pro`，只需要修改 `active` 属性即可。这种方式更加简洁，提高了配置切换的效率。

在多环境配置管理中，`group` 属性通过预定义不同环境下的配置组，实现了环境切换的便捷性。这不仅简化了配置文件的维护工作，还降低了因手动修改配置而引入错误的风险。例如，在微服务架构中，不同的服务可能需要连接到不同的数据库或消息队列，使用 `group` 属性可以轻松地为每个环境配置正确的连接信息。
