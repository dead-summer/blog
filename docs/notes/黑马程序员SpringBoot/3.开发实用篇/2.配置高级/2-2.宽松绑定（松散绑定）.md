---
title: 2-2.宽松绑定（松散绑定）
createTime: 2025/06/24 11:19:47
permalink: /notes/HMSpringBoot/ejcvjsmd/
---
在 Spring Boot 中进行属性绑定时，有时会遇到属性命名不一致的情况。为了代码规范，开发者可能会使用驼峰命名法，例如将 `datasource` 修改为 `dataSource`。本节将深入探讨 Spring Boot 的宽松绑定（或称松散绑定）机制，理解其原理和使用限制。

## 1. 宽松绑定的概念

宽松绑定是 Spring Boot 为了提升开发体验而引入的一种特性。它允许配置文件中的属性名与 Java 代码中的属性名在格式上具有一定的灵活性，从而减少因命名不匹配而导致的问题。

例如，在 `ServerConfig` 类中，`ipAddress` 属性可以使用多种命名方式在 YAML 配置文件中进行绑定：

```java
@Component
@Data
@ConfigurationProperties(prefix = "servers")
public class ServerConfig {
    private String ipAddress;
}
```

可以与下面的配置属性名规则全兼容

```yml
servers:
  ipAddress: 192.168.0.2       # 驼峰模式
  ip_address: 192.168.0.2      # 下划线模式
  ip-address: 192.168.0.2      # 烤肉串模式
  IP_ADDRESS: 192.168.0.2      # 常量模式
```

以上四种命名方式都可以成功匹配到 `ipAddress` 属性。

## 2. 宽松绑定的匹配原理

Spring Boot 在进行属性匹配时，会先将配置中的名称去除中划线和下划线，然后忽略大小写，再与 Java 代码中的属性名进行忽略大小写的等值匹配。以上述 `ipAddress` 为例，无论使用 `ipAddress`、`ip_address`、`ip-address` 还是 `IP_ADDRESS`，经过处理后都变为 `ipaddress`，与 Java 代码中的 `ipAddress` 忽略大小写后的结果一致，因此可以成功匹配。

尽管 Spring Boot 允许使用多种命名方式，但官方推荐使用烤肉串模式（kebab-case），即使用中划线分隔的命名方式。

## 3. `@ConfigurationProperties` 的前缀命名规范

在使用 `@ConfigurationProperties` 注解时，前缀的命名也需要遵循一定的规范。例如，如果将前缀设置为 `dataSource`，如下：

```java
@Bean
@ConfigurationProperties(prefix = "dataSource")
public DruidDataSource datasource(){
    DruidDataSource ds = new DruidDataSource();
    return ds;
}
```

可能会遇到以下错误：

```cmd
Configuration property name 'dataSource' is not valid:

    Invalid characters: 'S'
    Bean: datasource
    Reason: Canonical names should be kebab-case ('-' separated), lowercase alpha-numeric characters and must start with a letter

Action:
Modify 'dataSource' so that it conforms to the canonical names requirements.
```

错误信息表明，规范的名称应为烤肉串模式，即使用 `-` 分隔，使用小写字母数字字符，且必须以字母开头。因此，前缀应该使用 `data-source` 这样的形式：

```java
@Bean
@ConfigurationProperties(prefix = "data-source")
public DruidDataSource datasource(){
    DruidDataSource ds = new DruidDataSource();
    return ds;
}
```

## 4. `@Value` 注解的限制

需要注意的是，宽松绑定规则仅对使用 `@ConfigurationProperties` 注解进行属性绑定时有效，对使用 `@Value` 注解进行属性映射无效。
