---
title: 数组在计算机中的执行原理
createTime: 2025/06/25 20:22:30
permalink: /notes/HMJava/j8vvyo07/
---
## 3.1 数组的执行原理，Java 程序的执行原理

本节将通过一个示例代码，讲解变量和数组在 Java 程序中的执行原理。

```java
public class ArrayDemo1 {
    public static void main(String[] args) {
        int a = 10;
        System.out.println(a);

        int[] arr = new int[]{11, 22, 33};
        System.out.println(arr);

        System.out.println(arr[1]);

        arr[0] = 44;
        arr[1] = 55;
        arr[2] = 66;

        System.out.println(arr[0]);
        System.out.println(arr[1]);
        System.out.println(arr[2]);
    }
}
```

在 Java 中，程序是在内存中执行的。具体来说，Java 程序首先会被编译成字节码，然后加载到 Java 虚拟机（JVM）中执行。

为了更好地管理内存，JVM 将内存划分为五个区域：方法区、栈、堆、本地方法栈和寄存器。其中，**方法区、栈和堆** 是需要重点关注的区域。

*   **方法区**：用于存储已加载的字节码文件等信息。
*   **栈**：用于存储方法运行时所需要的内存空间，包括方法中的局部变量。
*   **堆**：用于存储通过 `new` 关键字创建的对象，并为对象分配内存地址。数组作为对象，也存储在堆中。

下图展示了上述代码在内存中的执行过程，序号 ① 到 ⑥ 标注了代码执行的顺序。

![[3.数组在计算机中的执行原理_附件/3.数组在计算机中的执行原理-20250625202507038.png]]

**`int a = 10` 与 `int[] arr = new int[]{11, 22, 33}` 的区别**

*   `int a = 10`：`a` 是一个基本类型变量，存储在栈内存中，存储的是数值 `10` 本身。
*   `int[] arr = new int[]{11, 22, 33}`：`arr` 是一个引用类型变量，存储在栈内存中，存储的是数组对象在堆内存中的地址值。

理解了变量和数组的内存分配方式，有助于理解后续的程序执行过程。接下来，我们将讨论多个变量指向同一个数组的情况。

## 3.2 多个变量指向同一个数组的问题

在实际开发中，可能会出现多个变量指向同一个数组对象的情况。理解这种情况的潜在问题非常重要。

示例代码如下：

```java
public class ArrayDemo2 {
    public static void main(String[] args) {
        // 目标：认识多个变量指向同一个数组对象的形式，并掌握其注意事项。
        int[] arr1 = {11, 22, 33};

        // 把int类型的数组变量arr1赋值给int类型的数组变量arr2
        int[] arr2 = arr1;

        System.out.println(arr1);
        System.out.println(arr2);

        arr2[1] = 99;
        System.out.println(arr1[1]);

        arr2 = null; // 拿到的数组变量中存储的值是null
        System.out.println(arr2);

        //System.out.println(arr2[0]);
        //System.out.println(arr2.length);
    }
}
```

关键代码段：

```java
int[] arr1 = {11, 22, 33};
int[] arr2 = arr1;
arr2[1] = 99;
```

::: steps

1. 执行完 `int[] arr1 = {11, 22, 33}` 后，`arr1` 指向堆内存中的一个数组对象，该数组对象存储了 `11`、`22` 和 `33` 三个元素。

	![[3.数组在计算机中的执行原理_附件/3.数组在计算机中的执行原理-20250625202911181.png]]

2. 执行完 `int[] arr2 = arr1` 后，`arr2` 也指向了 `arr1` 所指向的同一个数组对象。此时，`arr1` 和 `arr2` 存储的是同一个地址值。
	![[3.数组在计算机中的执行原理_附件/3.数组在计算机中的执行原理-20250625202938282.png]]
3. 执行到 `arr2[1] = 99` 时，通过 `arr2` 修改了数组的第二个元素。由于 `arr1` 和 `arr2` 指向同一个数组，因此 `arr1` 访问数组的第二个元素时，得到的值也会是修改后的 `99`。
	![[3.数组在计算机中的执行原理_附件/3.数组在计算机中的执行原理-20250625203018736.png]]
:::

::: note 总结

* 当两个变量指向同一个数组时，它们存储的是同一个地址值。
* 当一个变量修改数组中的元素时，另一个变量访问数组时，会得到修改后的值。
:::

理解了多个变量指向同一个数组的原理，可以避免在实际开发中出现意料之外的错误。至此，关于数组的基本操作和内存原理的学习就告一段落。
