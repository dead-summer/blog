---
title: 数据类型转换
createTime: 2025/06/24 19:42:06
permalink: /notes/HMJava/ww6jmlxz/
---
在实际开发中，我们经常需要将一种类型的变量值赋给另一种类型的变量，或者对多种数据类型的数据进行混合运算。这些情况都需要进行类型转换。类型转换主要分为两种形式：自动类型转换和强制类型转换。

## 3.1 自动类型转换

::: question 什么是自动类型转换？

自动类型转换是指将数据范围小的变量直接赋值给数据范围大的变量。

```java
byte a = 12;
int b = a; // 这里发生了自动类型转换 (把 byte 类型转换为 int 类型)
```

:::

自动类型转换的本质是在较小数据类型的数据前面补齐若干个字节，以达到与目标数据类型相同的长度。下图展示了各种数据类型之间自动类型转换的顺序：

![[3.数据类型转换_附件/3.数据类型转换-20250624194418144.png]]

**代码演示：**

下面的代码演示了自动类型转换的各种形式：

```java
public class TypeConversionDemo1 {
    public static void main(String[] args) {
        // 目标：理解自动类型转换机制。
        byte a = 12;
        int b = a; // 发生了自动类型转换
        System.out.println(a);
        System.out.println(b);

        int c = 100; // 4 bytes
        double d = c;// 8 bytes 发生了自动类型转换
        System.out.println(d);

        char ch = 'a'; // 'a' 97 => 00000000 01100001
        int i = ch; // 发生了自动类型转换 => 00000000 00000000 00000000 01100001
        System.out.println(i);
    }
}
```

这段代码展示了 `byte` 类型变量 `a` 自动转换为 `int` 类型变量 `b`，`int` 类型变量 `c` 自动转换为 `double` 类型变量 `d`，以及 `char` 类型变量 `ch` 自动转换为 `int` 类型变量 `i` 的过程。

下面我们介绍**表达式的自动类型转换**：表达式是由变量和数据通过运算符连接起来的式子。在表达式中，如果存在不同类型的变量或数据进行运算，结果的数据类型需要遵循以下规则：

1.  多种数据类型参与运算，结果以最大的数据类型为准。
2.  `byte`、`short`、`char` 三种类型的数据在与其他类型数据运算时，都会先转换为 `int` 类型再进行运算。

**代码演示：**

```java
public class TypeConversionDemo2 {
    public static void main(String[] args) {
        // 目标：掌握表达式的自动类型转换机制。
        byte a = 10;
        int b = 20;
        long c = 30;
        long rs = a + b + c;
        System.out.println(rs);

        double rs2 = a + b + 1.0;
        System.out.println(rs2);

        byte i = 10;
        short j = 30;
        int rs3 = i + j;
        System.out.println(rs3);

        // 面试笔试题： 即使两个 byte 运算，结果也会提升为 int
        byte b1 = 110;
        byte b2 = 80;
        int b3 = b1 + b2;
        System.out.println(b3);
    }
}
```

在上述代码中，`rs` 的计算涉及 `byte`、`int` 和 `long` 三种类型，结果为 `long` 类型。`rs2` 的计算涉及 `byte`、`int` 和 `double` 三种类型，结果为 `double` 类型。需要注意的是，即使是两个 `byte` 类型的变量进行运算，结果也会自动提升为 `int` 类型。这是因为 `byte`、`short` 和 `char` 在运算时都会自动转换为 `int` 类型。

## 3.2 强制类型转换

前面学习了自动类型转换，可以将数据范围小的数据直接赋值给数据范围大的变量。反之，将数据范围大的数据直接赋值给数据范围小的变量会报错，因为可能会发生数据溢出。但是，如果确实需要将范围大的数据赋值给范围小的变量，可以使用强制类型转换。

::: question 什么是强制类型转换？

强制类型转换是指，将数据范围大的数据强制转换为数据范围小的数据类型。强制类型转换的格式如下：

```java
目标数据类型 变量名 = (目标数据类型) 被转换的数据;
```

:::

**代码演示：**

```java
public class TypeConversionDemo3 {
    public static void main(String[] args) {
        // 目标：掌握强制类型转换。
        int a = 20;
        byte b = (byte) a; // ALT + ENTER 强制类型转换。
        System.out.println(a);
        System.out.println(b);

        int i = 1500;
        byte j = (byte) i;
        System.out.println(j);

        double d = 99.5;
        int m = (int) d; // 强制类型转换
        System.out.println(m); // 丢掉小数部分，保留整数部分
    }
}
```

以上代码展示了如何使用强制类型转换将 `int` 类型变量 `a` 转换为 `byte` 类型变量 `b`，以及将 `double` 类型变量 `d` 转换为 `int` 类型变量 `m`。需要注意的是，在将 `double` 类型转换为 `int` 类型时，会丢失小数部分。

强制类型转换的原理是直接截断多余的字节，这可能会导致数据丢失。

![[3.数据类型转换_附件/3.数据类型转换-20250624194719691.png]]

例如，当把一个 `int` 类型的数据强制转换为 `byte` 类型时，会将 `int` 类型数据的高 24 位截断，只保留低 8 位。如果原来的 `int` 类型数据的值超出了 `byte` 类型的表示范围，那么转换后的结果将会失去原有的精度。
