import{_ as r}from"./1.存储引擎-20250729152625542-DePBCEM8.js";import{a as g,c as o,b as l,e as s,d as k,f as i,w as n,r as d,o as y}from"./app-CAzY0Upz.js";const A="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804142317795-CWle2mP2.png",c="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804151654716-CsH1H_iG.png",u="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804153253446-BRwkWbFp.png",B="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804153631985-DbieSmrx.png",v="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804153729890-Bp-RtFN9.png",m="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804184130818-CCL8xC8-.png",b="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804184227931-Dyb7Wqnb.png",C="/blog/assets/6.InnoDB%E5%BC%95%E6%93%8E-20250804184302783-CNT9qRYD.png",D={},q={class:"hint-container example"},_={class:"hint-container example"},f={start:"3"};function E(x,a){const p=d("Tabs"),e=d("Mermaid");return y(),o("div",null,[a[19]||(a[19]=l('<h2 id="_6-1-逻辑存储结构" tabindex="-1"><a class="header-anchor" href="#_6-1-逻辑存储结构"><span>6.1 逻辑存储结构</span></a></h2><p>InnoDB 存储引擎的逻辑结构从大到小依次为：表空间 (Tablespace)、段 (Segment)、区 (Extent)、页 (Page)、行 (Row)。</p><img src="'+r+'" alt="1.存储引擎-20250729152625542" width="750" style="display:block;margin:auto;"><ul><li><p><strong>表空间 (Tablespace)</strong>： 是 InnoDB 存储引擎逻辑结构的最高层。如果启用了 <code>innodb_file_per_table</code> 参数 (在 MySQL 8.0 中默认开启)，则每张表都会有一个独立的表空间，即 <code>.ibd</code> 文件。一个 MySQL 实例可以对应多个表空间，用于存储记录、索引等数据。</p></li><li><p><strong>段 (Segment)</strong>： 分为数据段 (Leaf node segment)、索引段 (Non-leaf node segment) 和回滚段 (Rollback segment)。InnoDB 是索引组织表，数据段就是 B+ 树的叶子节点，索引段即为 B+ 树的非叶子节点。段用来管理多个区 (Extent)。</p></li><li><p><strong>区 (Extent)</strong>： 表空间的单元结构，每个区的大小为 1MB。默认情况下，InnoDB 存储引擎页大小为 16KB，即一个区中一共有 64 个连续的页。</p></li><li><p><strong>页 (Page)</strong>： 是 InnoDB 存储引擎磁盘管理的最小单元，每个页的大小默认为 16KB。为了保证页的连续性，InnoDB 存储引擎每次从磁盘申请 4-5 个区。</p></li><li><p><strong>行 (Row)</strong>： InnoDB 存储引擎数据是按行进行存放的。每行数据默认有两个隐藏字段：</p><ul><li><code>Trx_id</code>：每次对某条记录进行改动时，都会把对应的事务 id 赋值给 <code>trx_id</code> 隐藏列。</li><li><code>Roll_pointer</code>：每次对某条记录进行改动时，都会把旧的版本写入到 undo 日志中，然后这个隐藏列就相当于一个指针，可以通过它来找到该记录修改前的信息。</li></ul></li></ul><h2 id="_6-2-架构" tabindex="-1"><a class="header-anchor" href="#_6-2-架构"><span>6.2 架构</span></a></h2><h3 id="_6-2-1-概述" tabindex="-1"><a class="header-anchor" href="#_6-2-1-概述"><span>6.2.1 概述</span></a></h3><p>MySQL 5.5 版本开始，默认使用 InnoDB 存储引擎。它擅长事务处理，具有崩溃恢复特性，在日常开发中使用非常广泛。InnoDB 架构图分为内存结构和磁盘结构两部分。</p><img src="'+A+'" alt="6.InnoDB引擎-20250804142317795" width="750" style="display:block;margin:auto;"><h3 id="_6-2-2-内存结构" tabindex="-1"><a class="header-anchor" href="#_6-2-2-内存结构"><span>6.2.2 内存结构</span></a></h3><p>主要的内存结构包括：<code>Buffer Pool</code>、<code>Change Buffer</code>、<code>Adaptive Hash Index</code> 和 <code>Log Buffer</code>。</p><h4 id="_6-2-2-1-buffer-pool" tabindex="-1"><a class="header-anchor" href="#_6-2-2-1-buffer-pool"><span>6.2.2.1 Buffer Pool</span></a></h4><p>InnoDB 存储引擎基于磁盘文件存储，为了尽可能弥补磁盘 I/O 效率的不足，需要把经常使用的数据加载到缓冲池中，避免每次访问都进行磁盘 I/O。InnoDB 的缓冲池中不仅缓存了索引页和数据页，还包含了 Undo 页、插入缓存、自适应哈希索引以及 InnoDB 的锁信息等。</p><p>缓冲池是主内存中的一个区域，里面可以缓存磁盘上经常操作的真实数据。在执行增删改查操作时，先操作缓冲池中的数据 (若缓冲池没有数据，则从磁盘加载并缓存)，然后再以一定频率刷新到磁盘，从而减少磁盘 I/O，加快处理速度。</p><p>缓冲池以页 (Page) 为单位，底层采用链表数据结构管理页。根据状态，将 Page 分为三种类型：</p><ul><li><code>free page</code>：空闲 page，未被使用。</li><li><code>clean page</code>：被使用 page，数据没有被修改过。</li><li><code>dirty page</code>：脏页，被使用 page，数据被修改过，也即数据与磁盘的数据产生了不一致。</li></ul><p>在专用服务器上，通常将多达 80% 的物理内存分配给缓冲池。<code>innodb_buffer_pool_size</code> 参数用于设置缓冲池大小。</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">SHOW VARIABLES </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">innodb_buffer_pool_size</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_6-2-2-2-change-buffer" tabindex="-1"><a class="header-anchor" href="#_6-2-2-2-change-buffer"><span>6.2.2.2 Change Buffer</span></a></h4><p>更改缓冲区，针对非唯一二级索引页。在执行 DML 语句时，如果这些数据 Page 没有在 Buffer Pool 中，不会直接操作磁盘，而是会将数据变更存在更改缓冲区 Change Buffer 中，在未来数据被读取时，再将数据合并恢复到 Buffer Pool 中，再将合并后的数据刷新到磁盘中。使用 Change Buffer 可以在缓冲池中进行合并处理，减少磁盘 I/O。</p><p>理解 Change Buffer 的意义，需要先理解二级索引的结构。二级索引通常是非唯一的，并且以相对随机的顺序插入。删除和更新操作可能影响索引树中不相邻的二级索引页。如果每次都操作磁盘，会造成大量的磁盘 I/O。</p><h4 id="_6-2-2-3-adaptive-hash-index" tabindex="-1"><a class="header-anchor" href="#_6-2-2-3-adaptive-hash-index"><span>6.2.2.3 Adaptive Hash Index</span></a></h4><p>自适应 Hash 索引，用于优化对 Buffer Pool 数据的查询。虽然 InnoDB 引擎中没有直接支持 Hash 索引，但是 InnoDB 提供了自适应 Hash 索引的功能。因为 Hash 索引在进行等值匹配时，一般性能要高于 B+ 树（Hash 索引只需要一次 I/O）。但是 Hash 索引不适合做范围查询、模糊匹配等。</p><p>InnoDB 存储引擎会监控对表上各索引页的查询，如果观察到在特定的条件下 Hash 索引可以提升速度，则建立 Hash 索引，称之为自适应 Hash 索引。</p><p>自适应哈希索引，无需人工干预，是系统根据情况自动完成的。<code>adaptive_hash_index</code> 参数用于控制是否开启自适应哈希索引。</p><h4 id="_6-2-2-4-log-buffer" tabindex="-1"><a class="header-anchor" href="#_6-2-2-4-log-buffer"><span>6.2.2.4 Log Buffer</span></a></h4><p>日志缓冲区，用来保存要写入到磁盘中的 Log 日志数据 (Redo Log, Undo Log)。默认大小为 16MB，日志缓冲区的日志会定期刷新到磁盘中。如果需要更新、插入或删除许多行的事务，增加日志缓冲区的大小可以节省磁盘 I/O。</p><p><code>innodb_log_buffer_size</code> 参数用于设置日志缓冲区大小。<code>innodb_flush_log_at_trx_commit</code> 参数用于控制日志刷新到磁盘的时机，主要包含以下三个值：</p><ul><li><code>1</code>：日志在每次事务提交时写入并刷新到磁盘，默认值。</li><li><code>0</code>：每秒将日志写入并刷新到磁盘一次。</li><li><code>2</code>：日志在每次事务提交后写入，并每秒刷新到磁盘一次。</li></ul><h3 id="_6-2-3-磁盘结构" tabindex="-1"><a class="header-anchor" href="#_6-2-3-磁盘结构"><span>6.2.3 磁盘结构</span></a></h3><p>InnoDB 的磁盘结构主要包括：<code>System Tablespace</code> (系统表空间)、<code>File-Per-Table Tablespaces</code> (独立表空间)、<code>General Tablespaces</code> (通用表空间)、<code>Undo Tablespaces</code> (撤销表空间)、<code>Temporary Tablespaces</code> (临时表空间)、<code>Doublewrite Buffer Files</code> (双写缓冲区文件) 和 <code>Redo Log</code> (重做日志)。</p><h4 id="_6-2-3-1-system-tablespace" tabindex="-1"><a class="header-anchor" href="#_6-2-3-1-system-tablespace"><span>6.2.3.1 System Tablespace</span></a></h4><p>系统表空间是更改缓冲区的存储区域。如果表是在系统表空间而不是每个表文件或通用表空间中创建的，它也可能包含表和索引数据。(在 MySQL 5.x 版本中还包含 InnoDB 数据字典、Undo Log 等)。</p><p><code>innodb_data_file_path</code> 参数用于配置系统表空间。系统表空间，默认的文件名叫 <code>ibdata1</code>。</p><h4 id="_6-2-3-2-file-per-table-tablespaces" tabindex="-1"><a class="header-anchor" href="#_6-2-3-2-file-per-table-tablespaces"><span>6.2.3.2 File-Per-Table Tablespaces</span></a></h4><p>如果开启了 <code>innodb_file_per_table</code> 开关，则每个表的文件表空间包含单个 InnoDB 表的数据和索引，并存储在文件系统上的单个数据文件中。</p><p><code>innodb_file_per_table</code> 参数用于控制是否开启独立表空间，该参数默认开启。也就是说，我们没创建一个表，都会产生一个表空间文件，即 <code>.ibd</code> 文件。</p><h4 id="_6-2-3-3-general-tablespaces" tabindex="-1"><a class="header-anchor" href="#_6-2-3-3-general-tablespaces"><span>6.2.3.3 General Tablespaces</span></a></h4><p>通用表空间，需要通过 <code>CREATE TABLESPACE</code> 语法创建通用表空间，在创建表时，可以指定该表空间。</p><ol><li><strong>创建表空间</strong><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLESPACE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> ts_name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ADD</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DATAFILE </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">file_name.ibd</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ENGINE </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> engine_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><strong>创建表时指定表空间</strong><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> XXX</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> TABLESPACE ts_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h4 id="_6-2-3-4-undo-tablespaces" tabindex="-1"><a class="header-anchor" href="#_6-2-3-4-undo-tablespaces"><span>6.2.3.4 Undo Tablespaces</span></a></h4><p>撤销表空间，MySQL 实例在初始化时会自动创建两个默认的 Undo 表空间 (初始大小 16M)，用于存储 Undo Log 日志。</p><h4 id="_6-2-3-5-temporary-tablespaces" tabindex="-1"><a class="header-anchor" href="#_6-2-3-5-temporary-tablespaces"><span>6.2.3.5 Temporary Tablespaces</span></a></h4><p>InnoDB 使用会话临时表空间和全局临时表空间。存储用户创建的临时表等数据。</p><h4 id="_6-2-3-6-doublewrite-buffer-files" tabindex="-1"><a class="header-anchor" href="#_6-2-3-6-doublewrite-buffer-files"><span>6.2.3.6 Doublewrite Buffer Files</span></a></h4><p>双写缓冲区，InnoDB 引擎将数据页从 Buffer Pool 刷新到磁盘前，先将数据页写入双写缓冲区文件中，便于系统异常时恢复数据。</p><h4 id="_6-2-3-7-redo-log" tabindex="-1"><a class="header-anchor" href="#_6-2-3-7-redo-log"><span>6.2.3.7 Redo Log</span></a></h4><p>重做日志，是用来实现事务的持久性。该日志文件由两部分组成：重做日志缓冲 (Redo Log Buffer) 以及重做日志文件 (Redo Log)，前者是在内存中，后者在磁盘中。当事务提交之后会把所有修改信息都会存到该日志中，用于在刷新脏页到磁盘时，发生错误时，进行数据恢复使用。</p><p>以循环方式写入重做日志文件时，涉及两个文件：<code>ib_logfile0</code> 和 <code>ib_logfile1</code>。</p><h3 id="_6-2-4-后台线程" tabindex="-1"><a class="header-anchor" href="#_6-2-4-后台线程"><span>6.2.4 后台线程</span></a></h3><p>在 InnoDB 的后台线程中，分为 4 类，分别是：<code>Master Thread</code>、<code>IO Thread</code>、<code>Purge Thread</code>、<code>Page Cleaner Thread</code>。</p><img src="'+c+'" alt="6.InnoDB引擎-20250804151654716" width="750" style="display:block;margin:auto;"><ul><li><p><strong>Master Thread</strong> 核心后台线程，负责调度其他线程，还负责将缓冲池中的数据异步刷新到磁盘中，保持数据的一致性，还包括脏页的刷新、合并插入缓存、Undo 页的回收。</p></li><li><p><strong>IO Thread</strong> 在 InnoDB 存储引擎中大量使用了 AIO (Async IO) 来处理 I/O 请求，这样可以极大地提高数据库的性能，而 IO Thread 主要负责这些 I/O 请求的回调。</p><p>可以通过 <code>show engine innodb status \\G;</code> 指令，查看到 InnoDB 的状态信息，其中就包含 IO Thread 信息。</p></li><li><p><strong>Purge Thread</strong> 主要用于回收事务已经提交了的 Undo Log。在事务提交之后，若 Undo Log 不再使用，则使用 Purge Thread 回收。</p></li><li><p><strong>Page Cleaner Thread</strong> 协助 Master Thread 刷新脏页到磁盘的线程，它可以减轻 Master Thread 的工作压力，减少阻塞。</p></li></ul><h2 id="_6-3-事务原理" tabindex="-1"><a class="header-anchor" href="#_6-3-事务原理"><span>6.3 事务原理</span></a></h2><h3 id="_6-3-1-事务基础" tabindex="-1"><a class="header-anchor" href="#_6-3-1-事务基础"><span>6.3.1 事务基础</span></a></h3><p>事务是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p><p>事务特性如下：</p><ul><li><strong>原子性 (Atomicity)</strong>：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。</li><li><strong>一致性 (Consistency)</strong>：事务完成时，必须使所有的数据都保持一致状态。</li><li><strong>隔离性 (Isolation)</strong>：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立环境下运行。</li><li><strong>持久性 (Durability)</strong>：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li></ul><p>InnoDB 对事务特性的实现原理：</p><img src="'+u+'" alt="6.InnoDB引擎-20250804153253446" width="750" style="display:block;margin:auto;"><ul><li><strong>原子性、一致性、持久性</strong>：通过 <code>redo log</code>（重做日志）和 <code>undo log</code>（回滚日志）共同保障。</li><li><strong>隔离性</strong>：通过数据库锁机制和多版本并发控制（MVCC）实现。</li></ul><h3 id="_6-3-2-redo-log" tabindex="-1"><a class="header-anchor" href="#_6-3-2-redo-log"><span>6.3.2 Redo Log</span></a></h3><p>Redo Log 记录事务提交时数据页的物理修改，用于实现事务的持久性。它由两部分组成：</p><ul><li>Redo Log Buffer (重做日志缓冲区)：位于内存中。 修改数据时，先将变更写入 Redo Log Buffer。</li><li>Redo Log File (重做日志文件)：位于磁盘中。 事务提交时，将 buffer 内容刷新至 Redo Log File（顺序写入磁盘）。</li></ul><p>InnoDB 引擎先操作缓冲池中的数据，如果缓冲区没有对应的数据，会通过后台线程将磁盘中的数据加载出来，然后将缓冲池中的数据修改，修改后的数据页称为脏页。脏页会在一定的时机刷新到磁盘，但不是实时刷新，如果刷新过程出错，可能导致数据丢失，无法保证持久性。</p><img src="'+B+'" alt="6.InnoDB引擎-20250804153631985" width="750" style="display:block;margin:auto;"><p>对缓冲区的数据进行增删改之后，会首先将操作的数据页的变化，记录在 Redo Log Buffer 中。在事务提交时，会将 Redo Log Buffer 中的数据刷新到 Redo Log 磁盘文件中。如果在刷新缓冲区的脏页到磁盘时发生错误，此时就可以借助于 Redo Log 进行数据恢复，这样就保证了事务的持久性。如果脏页成功刷新到磁盘或者涉及到的数据已经落盘，此时 Redo Log 就没有作用了，就可以删除了，所以存在的两个 Redo Log 文件是循环写的。</p><img src="'+v+'" alt="6.InnoDB引擎-20250804153729890" width="750" style="display:block;margin:auto;"><p>每次提交事务时，都要刷新 Redo Log 到磁盘，而不是直接将 Buffer Pool 中的脏页刷新到磁盘。这是因为业务操作通常是随机读写磁盘，而 Redo Log 是顺序写入磁盘，顺序写的效率远高于随机写。</p><h3 id="_6-3-3-undo-log" tabindex="-1"><a class="header-anchor" href="#_6-3-3-undo-log"><span>6.3.3 Undo Log</span></a></h3><p>Undo Log 记录数据修改前的信息，用于事务回滚（保障原子性）和多版本并发控制（MVCC）。它记录了数据被修改前的信息，是一种逻辑日志。</p><p>当 <code>DELETE</code> 一条记录时，Undo Log 会记录一条对应的 <code>INSERT</code> 记录；当 <code>INSERT</code> 一条记录时，Undo Log 会记录一条对应的 <code>DELETE</code> 记录；当 <code>UPDATE</code> 一条记录时，Undo Log 会记录一条对应相反的 <code>UPDATE</code> 记录。当执行 <code>ROLLBACK</code> 时，就可以从 Undo Log 中读取逻辑记录并进行回滚。</p><p>Undo Log 在事务执行时产生，事务提交时不会立即删除，因为可能被 MVCC 使用。Undo Log 采用段 (segment) 的方式管理，存放在 rollback segment (回滚段) 中，每个回滚段包含 1024 个 undo log segment。</p><h2 id="_6-4-mvcc" tabindex="-1"><a class="header-anchor" href="#_6-4-mvcc"><span>6.4 MVCC</span></a></h2><h3 id="_6-4-1-基本概念" tabindex="-1"><a class="header-anchor" href="#_6-4-1-基本概念"><span>6.4.1 基本概念</span></a></h3><p><strong>当前读</strong>是指读取数据的最新版本，并且在读取时会对记录加锁，以防止其他并发事务修改。常见的当前读操作包括：</p><ul><li><code>SELECT ... LOCK IN SHARE MODE</code> (共享锁)</li><li><code>SELECT ... FOR UPDATE</code>、<code>UPDATE</code>、<code>INSERT</code>、<code>DELETE</code> (排他锁)</li></ul>',76)),s("div",q,[a[4]||(a[4]=s("p",{class:"hint-container-title"},"示例",-1)),a[5]||(a[5]=s("p",null,[i("在 "),s("code",null,"RR"),i(" 隔离级别下，事务 A 可以读取到事务 B 最新提交的内容，这是因为使用了 "),s("code",null,"LOCK IN SHARE MODE"),i(" 共享锁，执行的是当前读操作。")],-1)),k(p,{id:"361",data:[{id:"事务 A"},{id:"事务 B"}]},{title0:n(({value:h,isActive:t})=>a[0]||(a[0]=[i("事务 A",-1)])),title1:n(({value:h,isActive:t})=>a[1]||(a[1]=[i("事务 B",-1)])),tab0:n(({value:h,isActive:t})=>a[2]||(a[2]=[s("div",{class:"language-shell line-numbers-mode","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"begin"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"select"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," *"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," from"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stu"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," lock"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," in"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," share"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," mode"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," id"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," name"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," age"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," adam"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," cat"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," jetty"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," lei"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," luci"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"5"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," in"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])),tab1:n(({value:h,isActive:t})=>a[3]||(a[3]=[s("div",{class:"language-shell line-numbers-mode","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"begin"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"update"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stu"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," set"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," name"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ="),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," '"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"adam"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," where"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," id"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," row"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," matched:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  Changed:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  Warnings:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"commit"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("p",null,":::",-1)])),_:1})]),a[20]||(a[20]=l("<p>与当前读相对的是<strong>快照读</strong>，快照读读取的是数据的可见版本，可能是历史版本，不会加锁，属于非阻塞读。</p><p>不同隔离级别下，快照读的行为有所不同：</p><ul><li><strong>READ COMMITTED (RC)</strong>：每次 <code>SELECT</code> 都生成一个新的快照读。</li><li><strong>REPEATABLE READ (RR)</strong>：事务中第一个 <code>SELECT</code> 语句才是快照读，后续的 <code>SELECT</code> 语句都从该快照中读取数据。</li><li><strong>SERIALIZAVBLE</strong>：快照读会退化为当前读。</li></ul>",3)),s("div",_,[a[10]||(a[10]=s("p",{class:"hint-container-title"},"示例",-1)),a[11]||(a[11]=s("p",null,[i("即使事务 B 提交了数据，事务 A 中也查询不到，这是因为普通的 "),s("code",null,"SELECT"),i(" 是快照读。在 "),s("code",null,"RR"),i(" 隔离级别下，事务中第一个 "),s("code",null,"SELECT"),i(" 语句确定了快照版本，后续的 "),s("code",null,"SELECT"),i(" 语句都从该快照中获取数据，从而保证了可重复读。")],-1)),k(p,{id:"400",data:[{id:"事务 A"},{id:"事务 B"}]},{title0:n(({value:h,isActive:t})=>a[6]||(a[6]=[i("事务 A",-1)])),title1:n(({value:h,isActive:t})=>a[7]||(a[7]=[i("事务 B",-1)])),tab0:n(({value:h,isActive:t})=>a[8]||(a[8]=[s("div",{class:"language-shell line-numbers-mode","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"begin"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"select"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," *"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," from"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stu"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," id"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," name"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," age"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," adam"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," cat"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," jetty"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," lei"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," luci"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"5"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," in"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"select"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," *"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," from"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stu"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," id"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," name"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," age"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," adam"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   1"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," cat"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"   3"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," jetty"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  11"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," lei"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"   |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  19"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"|"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," 25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," luci"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  |"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  25"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"+----+-------+-----+")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"5"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," in"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])),tab1:n(({value:h,isActive:t})=>a[9]||(a[9]=[s("div",{class:"language-shell line-numbers-mode","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"begin"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"update"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," stu"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," set"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," name"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ="),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," '"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"carl"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," where"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," id"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," row"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," matched:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  Changed:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  Warnings:"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"mysql"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"> "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"commit"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"Query"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," OK,"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," rows"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," affected"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," (0.00 "),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"sec"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),s("p",null,":::",-1)])),_:1})]),a[21]||(a[21]=l(`<p><strong>MVCC (Multi-Version Concurrency Control)</strong>，即多版本并发控制，通过维护数据的多个版本来实现读写操作的并发执行，从而减少锁的竞争。快照读是 MySQL 实现 MVCC 的关键，它提供了一种非阻塞的读取数据的方式。MVCC 的实现依赖于数据库记录中的隐藏字段、<code>Undo Log</code> 日志和 <code>ReadView</code>。</p><h3 id="_6-4-2-隐藏字段" tabindex="-1"><a class="header-anchor" href="#_6-4-2-隐藏字段"><span>6.4.2 隐藏字段</span></a></h3><p>InnoDB 的表中除了定义的字段外，还有额外的三个隐藏字段：</p><table><thead><tr><th>字段名</th><th>说明</th></tr></thead><tbody><tr><td><code>DB_TRX_ID</code></td><td>最近修改事务 ID，记录插入这条记录或最后一次修改该记录的事务 ID。</td></tr><tr><td><code>DB_ROLL_PTR</code></td><td>回滚指针，指向这条记录的上一个版本，用于配合 Undo Log，指向上一个版本。</td></tr><tr><td><code>DB_ROW_ID</code></td><td>隐藏主键，如果表结构没有指定主键，将会生成该隐藏字段。</td></tr></tbody></table><p><code>DB_ROW_ID</code> 只有在没有主键的情况下才会添加。</p><div class="hint-container example"><p class="hint-container-title">有主键的表</p><p>使用 <code>ibd2sdi stu.ibd</code> 命令可以查看 <code>.ibd</code> 文件中的表结构信息。</p><p>在表结构信息的 <code>columns</code> 部分，可以找到隐藏字段的信息。从输出结果中可以看到 <code>DB_TRX_ID</code> 和 <code>DB_ROLL_PTR</code> 两个隐藏字段。</p><div class="language-json line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="json" style="--vp-collapsed-lines:15;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DB_TRX_ID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_nullable</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_zerofill</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_unsigned</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_auto_increment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_virtual</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">hidden</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">ordinal_position</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">char_length</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">has_no_default</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">update_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">comment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">options</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">se_private_data</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">table_id=1146;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">secondary_engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_key</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_type_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elements</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">collation_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 63</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_explicit_collation</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><div class="language-json line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="json" style="--vp-collapsed-lines:15;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DB_ROLL_PTR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 9</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_nullable</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_zerofill</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_unsigned</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_auto_increment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_virtual</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">hidden</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">ordinal_position</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">char_length</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">has_no_default</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">update_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">comment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">options</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">se_private_data</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">table_id=1146;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">secondary_engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_key</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_type_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elements</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">collation_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 63</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_explicit_collation</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>因为该表有主键，所以没有 <code>DB_ROW_ID</code> 隐藏字段。</p></div><div class="hint-container example"><p class="hint-container-title">无主键的表</p><p>创建一个无主键的表：</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">create</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> table</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> employee</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">int</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> , </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> varchar</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">10</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>此时再使用 <code>ibd2sdi</code> 命令查看表结构，就可以发现 <code>DB_ROW_ID</code> 隐藏字段。</p><div class="language-json line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="json" style="--vp-collapsed-lines:15;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DB_ROW_ID</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_nullable</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_zerofill</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_unsigned</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_auto_increment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_virtual</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">hidden</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">ordinal_position</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">char_length</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">numeric_scale_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">datetime_precision_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">has_no_default</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">srs_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8_null</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_value_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">default_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">update_option</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">comment</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">generation_expression_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">options</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">se_private_data</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">table_id=1147;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">secondary_engine_attribute</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_key</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">column_type_utf8</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elements</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">collation_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 63</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">	&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">is_explicit_collation</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></div><h3 id="_6-4-3-undo-log" tabindex="-1"><a class="header-anchor" href="#_6-4-3-undo-log"><span>6.4.3 Undo Log</span></a></h3><h4 id="_6-4-3-1-介绍" tabindex="-1"><a class="header-anchor" href="#_6-4-3-1-介绍"><span>6.4.3.1 介绍</span></a></h4><p>回滚日志 (Undo Log) 是在执行 <code>INSERT</code>、<code>UPDATE</code> 和 <code>DELETE</code> 操作时产生的，用于数据回滚的日志。</p><ul><li>对于 <code>INSERT</code> 操作，产生的 Undo Log 只在回滚时需要，事务提交后可以立即删除。</li><li>对于 <code>UPDATE</code> 和 <code>DELETE</code> 操作，产生的 Undo Log 不仅在回滚时需要，在快照读 (Snapshot Read) 时也需要，因此不会立即被删除。</li></ul><h4 id="_6-4-3-2-版本链" tabindex="-1"><a class="header-anchor" href="#_6-4-3-2-版本链"><span>6.4.3.2 版本链</span></a></h4><p>版本链 (Version Chain) 是指由于多个事务并发修改同一条记录，导致该记录的 Undo Log 形成的一条链表，用于实现多版本并发控制 (MVCC)。</p><p>以一个原始数据表为例，该表结构包含以下列：</p><table><thead><tr><th><code>id</code></th><th><code>age</code></th><th><code>name</code></th><th><code>DB_TRX_ID</code></th><th><code>DB_ROLL_PTR</code></th></tr></thead><tbody><tr><td><code>30</code></td><td><code>30</code></td><td><code>A30</code></td><td><code>1</code></td><td><code>null</code></td></tr></tbody></table><ul><li><code>DB_TRX_ID</code>：代表最近修改事务 ID，记录插入这条记录或最后一次修改该记录的事务 ID，是自增的。</li><li><code>DB_ROLL_PTR</code>：回滚指针，指向 Undo Log 链表中的上一个版本。由于初始数据是新插入的，尚未被更新，因此该字段值为 <code>null</code>。</li></ul><p>现有四个并发事务同时访问这张表，时序图如下：</p>`,17)),k(e,{code:"eJyFkDFuwkAQRXufYpp0W9iehSBLLtLkDOmiFayQpdiO8CZKmToUSZE+ShREBzUIicvYFsdgZo1dgLVY3mb0NPP+n6rMGA/omyij7/NZqgw82IF6S4rT4Kbw7KjQY5PkGZTbefXxG9pZtXuvlvNmApEi4FULMOFjYdTMCPAFBBYs96v6ewPJJEZfqKmOMWLs5ZkvEyQALVd/fpXb/3YhI+M8TRNahQJknwgCuFTQrZKpVMd3yKews5EChr022NncChj12UiXi7xwqX8Wh/Vf4wIRA/qJ9lEd9DcVXzQXEMm7WtsRwb5rW8gAvdPJs0yyyxRQxUFvxwNXqsG1VAS0qYbUnAthVX7oHQGmdfEH"}),a[22]||(a[22]=s("p",null,[s("strong",null,"事务执行过程：")],-1)),s("ol",null,[s("li",null,[a[12]||(a[12]=l("<p><strong>事务 2 修改数据：</strong></p><ul><li>事务 2 执行 <code>UPDATE</code> 语句，将 <code>id=30</code> 的记录的 <code>age</code> 字段修改为 <code>3</code>。</li><li>在修改之前，会记录 Undo Log 日志，保存数据变更之前的样子。</li><li>更新记录，记录本次操作的事务 ID (<code>DB_TRX_ID</code>) 和回滚指针 (<code>DB_ROLL_PTR</code>)，回滚指针指向 Undo Log 中保存的旧版本数据。</li></ul>",2)),k(e,{code:"eJyFkLFuwjAQhvc8xS3dPCQ5QxFShi59hm6VRSwUqUkq4lYdO5ehHbojEIgNZhASL5NEPAZnhwQJHIji5fT593f/UCRKOUBfKJR8TkexUPBiBuIryk6Dh8wxo0wOVJQmkG/Hxc/UN7Ni910sx9UE+mGaSAbKf82UGCkGLgPPYPl+Vf5vIAoDdJkYygD7gsI+K/rjXT9PLAM0ePn7l2/ndapGBmkcR5SIDLjNBgHaffC2TyJiGTyhfggbF86ga3XBxuWRQc/mwttN+JVJOVkc1rPKBM6lECjfKJUqob/q+qpEj25otHbuEexaUps0XwN0Tk9fbMabzTyq2bP23GnfrXNnNw3UO3WpvVuIFtUHnSPVsvMf"}),a[13]||(a[13]=i()),a[14]||(a[14]=s("img",{src:m,alt:"6.InnoDB引擎-20250804184130818",width:"750",style:{display:"block",margin:"auto"}},null,-1))]),s("li",null,[a[15]||(a[15]=l("<p><strong>事务 3 修改数据：</strong></p><ul><li>事务 3 执行 <code>UPDATE</code> 语句，将 <code>id=30</code> 的记录的 <code>name</code> 字段修改为 <code>A3</code>。</li><li>同样，记录 Undo Log 日志，保存数据变更之前的样子。</li><li>更新记录，记录本次操作的事务 ID 和回滚指针，回滚指针指向 Undo Log 中保存的旧版本数据。</li></ul>",2)),k(e,{code:"eJyFkLFuwjAURfd8xVu6eUhiQxFShi79hm6VRSwUqUkq4laMzDDAwI5AIDaYQUj8TBLxGTw7BBBxIIqXp+Pr826XR1JagJ/PpfiMeyGX8KUHvB8kl8FbYulRIjoyiCNI96NsOHf1LDsMsvWomEDbjyNBQLrfieQ9ScAm4GgsPW7y6Q4C36M24V3h0Rv796seR5IA1XA+nqT7ZSWzE4dhgKGUADMJUYB6JfpcKeKh8D4otDkm/hcXSi9GoGnwUkip9E6gZVJi9UKsIpTPVqftohC6x8QPZmI5+BedV8p0kFdoadxC2DZkXtNcBeC5PPywF7vu5WDXjrHsRv1mjRebKaDcqYndPUOUqDrUOgNpdPXt"})])]),a[23]||(a[23]=s("img",{src:b,alt:"6.InnoDB引擎-20250804184227931",width:"750",style:{display:"block",margin:"auto"}},null,-1)),s("ol",f,[s("li",null,[a[16]||(a[16]=l("<p><strong>事务 4 修改数据：</strong></p><ul><li>事务 4 执行 <code>UPDATE</code> 语句，将 <code>id=30</code> 的记录的 <code>age</code> 字段修改为 <code>10</code>。</li><li>同样，记录 Undo Log 日志，保存数据变更之前的样子。</li><li>更新记录，记录本次操作的事务 ID 和回滚指针，回滚指针指向 Undo Log 中保存的旧版本数据。</li></ul>",2)),k(e,{code:"eJyNkL1OwzAUhXc/xV3YPCS5aamQMrDwDGzIaqwqEklQYxAjMx1gYEcgULd2blWpL5NEfYxex3V/FKeqZS9Xx+d+57CRyJRiDOjEQsm7fJwKBfdmIl6TYje5KpiZFXKokjyDcjmp3n+CZlat3qrpxEzgJs4zyUEFD4USY8XB4+A3snI9q78WkMQRelyMZIQH7fOTXk9KDtiI64/PcvnX8hzmaZqQKXIIXUAI0I2E55EykcroFo/klirk0O+mwj3VNYeBiyrsZgpbTPX3/2b+a5iOZfKRPKkfuqb2Vp8+6QXtfTE/LP2A/ngO671poAX0dvtPMmojG8+n1n1n7b3ugL3LApLMBuxTkS5cK9G4+iHbApSS+6s="}),a[17]||(a[17]=i()),a[18]||(a[18]=s("img",{src:C,alt:"6.InnoDB引擎-20250804184302783",width:"750",style:{display:"block",margin:"auto"}},null,-1))])]),a[24]||(a[24]=l('<p>通过以上过程，我们可以发现，不同的事务或相同事务对同一条记录进行修改，会导致该记录的 Undo Log 生成一条记录版本链表。链表的头部是最新的旧记录，链表尾部是最早的旧记录。这个版本链是实现 MVCC 的关键。</p><h3 id="_6-4-4-readview" tabindex="-1"><a class="header-anchor" href="#_6-4-4-readview"><span>6.4.4 ReadView</span></a></h3><p>ReadView (读视图) 是快照读 SQL 执行时 MVCC 提取数据的依据，记录并维护系统当前活跃的事务 (未提交的) id。ReadView 中包含了四个核心字段：</p><ul><li><code>m_ids</code>：当前活跃的事务 ID 集合。</li><li><code>min_trx_id</code>：最小活跃事务 ID。</li><li><code>max_trx_id</code>：预分配事务 ID，当前最大事务 ID + 1 (因为事务 ID 是自增的)。</li><li><code>creator_trx_id</code>：ReadView 创建者的事务 ID。</li></ul><p>ReadView 中规定了版本链数据的访问规则，其中 <code>trx_id</code> 代表当前 Undo Log 版本链对应事务 ID。</p><table><thead><tr><th style="text-align:left;">条件</th><th style="text-align:left;">访问权限</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>trx_id == creator_trx_id</code></td><td style="text-align:left;">可以访问</td><td style="text-align:left;">数据是当前这个事务更改的</td></tr><tr><td style="text-align:left;"><code>trx_id &lt; min_trx_id</code></td><td style="text-align:left;">可以访问</td><td style="text-align:left;">数据已经提交了</td></tr><tr><td style="text-align:left;"><code>trx_id &gt; max_trx_id</code></td><td style="text-align:left;">不可以访问</td><td style="text-align:left;">该事务是在 ReadView 生成后才开启</td></tr><tr><td style="text-align:left;"><code>min_trx_id &lt;= trx_id &lt;= max_trx_id</code> (如果 <code>trx_id</code> 不在 <code>m_ids</code> 中)</td><td style="text-align:left;">可以访问</td><td style="text-align:left;">数据已经提交</td></tr></tbody></table><p>不同的隔离级别，生成 ReadView 的时机不同：</p><ul><li><strong>READ COMMITTED (RC)</strong>：在事务中每一次执行快照读时生成 ReadView。</li><li><strong>REPEATABLE READ (RR)</strong>：仅在事务中第一次执行快照读时生成 ReadView，后续复用该 ReadView。</li></ul><h3 id="_6-4-5-原理分析" tabindex="-1"><a class="header-anchor" href="#_6-4-5-原理分析"><span>6.4.5 原理分析</span></a></h3><h4 id="_6-4-5-1-rc-隔离级别" tabindex="-1"><a class="header-anchor" href="#_6-4-5-1-rc-隔离级别"><span>6.4.5.1 RC 隔离级别</span></a></h4><p>RC 隔离级别下，在事务中每一次执行快照读时生成 ReadView。</p><p>为了更清晰地理解，我们来分析事务 5 中，两次快照读读取数据，是如何获取数据的。在事务 5 中，查询了两次 id 为 30 的记录，由于隔离级别为 Read Committed，所以每一次进行快照读都会生成一个 ReadView。</p>',12)),k(e,{code:"eJyFkLGKwkAQhvs8xTTXbZFkVk+EFNfcM1x3LLpI4JIcZgVLay20sBdFsdNaEXyZJPgYzm6MiC5x2W2Gj9nv/3siVsoBOl2h5HfSj4SCHzMQwzC9DT5Sx4xS2VFhEkN2nOTjpW9m+WmUbyflBNqg/N9Uib5i4DLwDJGdd8X8AGE3QJeJngzQYIN//SVBDNBwxXSWHdePmzpJFIW0ChlwmwECWB2w3iEWkQy+sCQrDc6gadXAu8Yng5ZNg1sl+ItEsdhc9qtSAtoakH+0iAqgW7b50pVHpN5VabYIduu2+Rqgd/vyKQy/h/GoVM/aasMap/EuDgFVnCZ1VYdoR/3QuQLAeOZn"}),a[25]||(a[25]=l(`<p>假设在上述并发场景中，事务 5 在某一时刻（事务 2 提交后，事务 3、4 仍未提交，事务 5 刚刚开始时）执行了对 <code>id=30</code> 记录的第一次快照读。此时，会生成一个 ReadView。</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">m_ids</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">min_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">max_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">creator_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当生成 ReadView 后，系统会根据 Undo Log 中的版本链，从最新的版本开始，逐一向上匹配记录的 <code>DB_TRX_ID</code> (事务 ID)，并与 ReadView 的访问规则进行比较，以确定可见的快照。</p><ol><li><strong>匹配 <code>DB_TRX_ID</code> 为 4 的记录：</strong> 这条记录对应的 <code>trx_id</code> 为 4。根据 ReadView 规则，<code>trx_id</code> 为 4 不满足任何可见性条件，继续匹配下一条。</li><li><strong>匹配 <code>DB_TRX_ID</code> 为 3 的记录：</strong> 这条记录对应的 <code>trx_id</code> 为 3。同样 <code>trx_id</code> 为 3 不满足任何可见性条件，继续匹配下一条。</li><li><strong>匹配 <code>DB_TRX_ID</code> 为 2 的记录：</strong> 这条记录对应的 <code>trx_id</code> 为 2。此时满足 <code>trx_id &lt; min_trx_id</code>，这意味着事务 2 在 ReadView 生成之前就已经提交，因此它的修改是可见的。匹配终止，第一次快照读返回的数据是版本链中由事务 2 修改的那条记录</li></ol><p>在第一次快照读之后，事务 4 仍在活跃，事务 2, 3 已经提交，并且事务 5 再次查询 <code>id=30</code> 的记录。由于 RC 隔离级别下每次快照读都生成新的 ReadView，此时事务 5 的第二次快照读将生成一个新的 ReadView。</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">m_ids</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">min_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">max_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">creator_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>系统再次从 Undo Log 的版本链，从最新的版本开始，逐一向上匹配：</p><ol><li><strong>匹配 <code>DB_TRX_ID</code> 为 4 的记录：</strong> 这条记录对应的 <code>trx_id</code> 为 4。如果 <code>trx_id</code> 为 4 不满足 ReadView 的可见性条件，则继续匹配下一条。</li><li><strong>匹配 <code>DB_TRX_ID</code> 为 3 的记录：</strong> 这条记录对应的 <code>trx_id</code> 为 3。此时满足 <code>trx_id &lt; min_trx_id</code>，这意味着事务 3 在 ReadView 生成之前就已经提交，因此它的修改是可见的。匹配终止，第二次快照读返回的数据是版本链中由事务 3 修改的那条记录。</li></ol><p>综上所述，在 RC 隔离级别下，每次快照读都会根据当前时刻的系统状态生成新的 ReadView，并依据此 ReadView 以及 Undo Log 版本链的访问规则来确定可见的数据版本。这解释了 RC 隔离级别下可能出现不可重复读（Non-Repeatable Read）现象的原因。</p><h4 id="_6-4-5-rr-隔离级别" tabindex="-1"><a class="header-anchor" href="#_6-4-5-rr-隔离级别"><span>6.4.5 RR 隔离级别</span></a></h4><p>RR 隔离级别下，仅在事务中第一次执行快照读时生成 ReadView，后续复用该 ReadView。RR 是可重复读，在一个事务中，执行两次相同的 <code>SELECT</code> 语句，查询到的结果是一样的。</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">m_ids</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">min_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">max_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">creator_trx_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 RR 隔离级别下，由于事务的整个生命周期内都复用首次快照读生成的 ReadView，所以 ReadView 的 <code>m_ids</code>、<code>min_trx_id</code>、<code>max_trx_id</code> 和 <code>creator_trx_id</code> 等属性在事务中保持不变。这意味着，无论外部事务如何修改并提交数据，只要这些修改在事务 5 的第一次快照读时没有被其 ReadView 视为可见，那么在事务 5 后续的快照读中，这些修改也依然不可见。</p>`,13))])}const I=g(D,[["render",E]]),L=JSON.parse('{"path":"/notes/HMMySQL/hczbnb7u/","title":"InnoDB引擎","lang":"zh-CN","frontmatter":{"title":"InnoDB引擎","createTime":"2025/08/04 14:18:52","permalink":"/notes/HMMySQL/hczbnb7u/"},"readingTime":{"minutes":23.25,"words":6974},"git":{"createdTime":1754306652000,"updatedTime":1754306652000,"contributors":[{"name":"dead_summer","username":"","email":"2941325451@qq.com","commits":1,"avatar":"https://gravatar.com/avatar/d7f172441d823f01ad688f425860dbe76a31ea11c9936176bbd8c14670a619f8?d=retro"}]},"filePathRelative":"notes/黑马程序员MySQL/2.进阶篇/6.InnoDB引擎.md","headers":[]}');export{I as comp,L as data};
