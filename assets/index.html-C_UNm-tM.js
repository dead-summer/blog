import{a as i,c as a,b as n,o as l}from"./app-CAzY0Upz.js";const t={};function e(h,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_9-1-log4j-架构概览" tabindex="-1"><a class="header-anchor" href="#_9-1-log4j-架构概览"><span>9.1 Log4j 架构概览</span></a></h2><p>Log4j 是一个组件化的日志系统，它允许将日志信息输出到不同的目的地，并提供了灵活的过滤和格式化功能。其核心组件包括：</p><ul><li><strong>Appender</strong>：定义日志的输出目的地，例如控制台、文件、网络套接字或数据库。</li><li><strong>Filter</strong>：用于过滤需要输出的日志信息，可以根据日志级别或其他条件进行过滤。</li><li><strong>Layout</strong>：负责格式化日志信息的输出格式，例如添加日期、时间、线程信息等。</li></ul><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>log.info(&quot;User signed in.&quot;);</span></span>
<span class="line"><span> │</span></span>
<span class="line"><span> │   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐</span></span>
<span class="line"><span> ├──▶│ Appender │───▶│  Filter  │───▶│  Layout  │───▶│ Console  │</span></span>
<span class="line"><span> │   └──────────┘    └──────────┘    └──────────┘    └──────────┘</span></span>
<span class="line"><span> │</span></span>
<span class="line"><span> │   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐</span></span>
<span class="line"><span> ├──▶│ Appender │───▶│  Filter  │───▶│  Layout  │───▶│   File   │</span></span>
<span class="line"><span> │   └──────────┘    └──────────┘    └──────────┘    └──────────┘</span></span>
<span class="line"><span> │</span></span>
<span class="line"><span> │   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐</span></span>
<span class="line"><span> └──▶│ Appender │───▶│  Filter  │───▶│  Layout  │───▶│  Socket  │</span></span>
<span class="line"><span>     └──────────┘    └──────────┘    └──────────┘    └──────────┘</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9-2-log4j-配置详解" tabindex="-1"><a class="header-anchor" href="#_9-2-log4j-配置详解"><span>9.2 Log4j 配置详解</span></a></h2><p>Log4j 通过配置文件进行配置，通常使用 XML 格式。以下是一个 <code>log4j2.xml</code> 配置文件的示例，并对其进行了详细解释：</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-xml"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;?</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">xml</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> version</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> encoding</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">UTF-8</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Configuration</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Properties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        &lt;!-- 定义日志格式 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">log.pattern</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">%d{MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36}%n%msg%n%n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        &lt;!-- 定义文件名变量 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">file.err.filename</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">log/err.log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">file.err.pattern</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">log/err.%i.log.gz</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Property</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Properties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    &lt;!-- 定义Appender，即目的地 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Appenders</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        &lt;!-- 定义输出到屏幕 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Console</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">console</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> target</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">SYSTEM_OUT</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            &lt;!-- 日志格式引用上面定义的log.pattern --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">PatternLayout</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pattern</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\${log.pattern}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Console</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        &lt;!-- 定义输出到文件,文件名引用上面定义的file.err.filename --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">RollingFile</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">err</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> bufferedIO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">true</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> fileName</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\${file.err.filename}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> filePattern</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\${file.err.pattern}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">PatternLayout</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pattern</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">\${log.pattern}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Policies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                &lt;!-- 根据文件大小自动切割日志 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">				&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SizeBasedTriggeringPolicy</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> size</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1 MB</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Policies</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            &lt;!-- 保留最近10份 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DefaultRolloverStrategy</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> max</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">RollingFile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Appenders</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Loggers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Root</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> level</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">info</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            &lt;!-- 对info级别的日志，输出到console --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AppenderRef</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ref</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">console</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> level</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">info</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            &lt;!-- 对error级别的日志，输出到err，即上面定义的RollingFile --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">			&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AppenderRef</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ref</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">err</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> level</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">		&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Root</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">	&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Loggers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Configuration</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>代码解释：</strong></p><ul><li><strong><code>&lt;Configuration&gt;</code></strong>：根节点，包含整个 Log4j 的配置信息。</li><li><strong><code>&lt;Properties&gt;</code></strong>：定义全局属性，例如日志格式 (<code>log.pattern</code>) 和文件名 (<code>file.err.filename</code>, <code>file.err.pattern</code>)。 <ul><li><code>log.pattern</code> 定义了日志输出的格式，其中 <code>%d</code> 表示日期，<code>%t</code> 表示线程名，<code>%-5level</code> 表示日志级别，<code>%logger{36}</code> 表示 logger 名称，<code>%msg</code> 表示日志消息。</li><li><code>file.err.filename</code> 定义了错误日志的文件名。</li><li><code>file.err.pattern</code> 定义了滚动日志的文件名模式，用于指定日志文件切割后的命名规则。</li></ul></li><li><strong><code>&lt;Appenders&gt;</code></strong>：定义日志的输出目的地。 <ul><li><strong><code>&lt;Console&gt;</code></strong>：将日志输出到控制台。<code>target=&quot;SYSTEM_OUT&quot;</code> 表示输出到标准输出流。</li><li><strong><code>&lt;RollingFile&gt;</code></strong>：将日志输出到文件，并根据策略进行滚动（切割）。 <ul><li><code>fileName</code>：指定当前日志文件的名称。</li><li><code>filePattern</code>：指定日志文件滚动时的命名规则。<code>%i</code> 会被替换为递增的数字，<code>.gz</code> 表示使用 gzip 压缩。</li><li><strong><code>&lt;Policies&gt;</code></strong>：定义日志滚动策略。 <ul><li><strong><code>&lt;SizeBasedTriggeringPolicy&gt;</code></strong>：基于文件大小触发滚动。<code>size=&quot;1 MB&quot;</code> 表示当日志文件达到 1MB 时进行滚动。</li></ul></li><li><strong><code>&lt;DefaultRolloverStrategy&gt;</code></strong>：定义滚动策略。 <ul><li><code>max=&quot;10&quot;</code> 表示最多保留 10 个滚动日志文件。</li></ul></li></ul></li></ul></li><li><strong><code>&lt;Loggers&gt;</code></strong>：定义 Logger 的配置。 <ul><li><strong><code>&lt;Root&gt;</code></strong>：根 Logger，用于配置全局的日志级别和 Appender。 <ul><li><code>level=&quot;info&quot;</code>：设置根 Logger 的日志级别为 INFO，表示会输出 INFO、WARN、ERROR 和 FATAL 级别的日志。</li><li><strong><code>&lt;AppenderRef&gt;</code></strong>：引用已定义的 Appender。 <ul><li><code>ref=&quot;console&quot;</code>：引用名为 &quot;console&quot; 的 Appender，用于将日志输出到控制台。</li><li><code>ref=&quot;err&quot;</code>：引用名为 &quot;err&quot; 的 Appender，用于将日志输出到文件。</li></ul></li></ul></li></ul></li></ul><p>总而言之，该配置文件的作用是：将 INFO 级别的日志输出到控制台，同时将 ERROR 级别的日志输出到文件，并且当日志文件达到 1MB 时进行滚动，最多保留 10 个滚动日志文件。通过灵活配置 Appender，可以满足各种日志输出需求。</p><h2 id="_9-3-log4j-的使用步骤" tabindex="-1"><a class="header-anchor" href="#_9-3-log4j-的使用步骤"><span>9.3 Log4j 的使用步骤</span></a></h2><ol><li><strong>下载 Log4j 2 的相关 jar 包</strong>。可以从 <a href="https://logging.apache.org/log4j/2.x/download.html" target="_blank" rel="noopener noreferrer">Apache Logging Services</a> 下载。</li><li><strong>将必要的 jar 包添加到 classpath 中</strong>。至少需要以下三个 jar 包： <ul><li><code>log4j-api-2.x.jar</code></li><li><code>log4j-core-2.x.jar</code></li><li><code>log4j-jcl-2.x.jar</code> (如果使用 Commons Logging 作为日志接口)</li></ul></li><li><strong>放置 <code>log4j2.xml</code> 配置文件到 classpath 根目录下</strong>。</li><li><strong>如果使用 Commons Logging，需要将 <code>commons-logging-1.2.jar</code> 也添加到 classpath 中</strong>。</li></ol><p>完成以上步骤后，就可以像使用 Commons Logging 一样使用 Log4j 进行日志输出了。</p><h2 id="_9-4-最佳实践" tabindex="-1"><a class="header-anchor" href="#_9-4-最佳实践"><span>9.4 最佳实践</span></a></h2><ul><li><strong>始终使用 Commons Logging 接口来写入日志</strong>：这样可以在不修改代码的情况下切换不同的日志实现。</li><li><strong>在开发阶段无需引入 Log4j</strong>：只有在需要将日志写入文件时，才需要将 <code>log4j2.xml</code> 配置文件和 Log4j 相关的 jar 包放入 classpath。</li></ul>`,15)]))}const p=i(t,[["render",e]]),r=JSON.parse('{"path":"/notes/LXFJava/rkrp6qia/","title":"使用Log4j","lang":"zh-CN","frontmatter":{"title":"使用Log4j","createTime":"2025/07/15 14:51:01","permalink":"/notes/LXFJava/rkrp6qia/"},"readingTime":{"minutes":3.66,"words":1098},"git":{"createdTime":1752577864000,"updatedTime":1752577864000,"contributors":[{"name":"dead_summer","username":"","email":"2941325451@qq.com","commits":1,"avatar":"https://gravatar.com/avatar/d7f172441d823f01ad688f425860dbe76a31ea11c9936176bbd8c14670a619f8?d=retro"}]},"filePathRelative":"notes/廖雪峰Java/4.异常处理/9.使用Log4j.md","headers":[]}');export{p as comp,r as data};
