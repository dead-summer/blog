import{a as i,c as l,b as n,o}from"./app-CAzY0Upz.js";const r="/blog/assets/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-20250830171158147-B2bZn3BV.png",s={};function a(e,t){return o(),l("div",null,t[0]||(t[0]=[n('<p>MySQL 主从复制是一种数据同步机制，通过将主数据库的 DDL（数据定义语言）和 DML（数据操作语言）操作记录到二进制日志（BinLog）中，并将这些日志传输到从服务器。从服务器重放这些日志，以保持与主服务器的数据一致性。</p><h2 id="复制过程" tabindex="-1"><a class="header-anchor" href="#复制过程"><span>复制过程</span></a></h2><p>MySQL 主从复制的核心步骤如下：</p><ol><li><strong>从服务器线程初始化</strong>：从服务器启动复制时，创建两个线程： <ul><li><strong>I/O 线程</strong>：负责与主服务器通信。</li><li><strong>SQL 线程</strong>：负责在从服务器本地执行操作。</li></ul></li><li><strong>主从连接建立</strong>： <ul><li>从服务器的 I/O 线程主动连接主服务器。</li><li>主服务器响应连接后，启动一个 <strong>BinLog Dump 线程</strong>，专门处理与从服务器 I/O 线程的交互。</li></ul></li><li><strong>BinLog 位置同步</strong>： <ul><li>从服务器的 I/O 线程向主服务器指定起始位置（例如 BinLog 文件名和偏移量），请求传输 BinLog。</li><li>主服务器在数据更新过程中，将更改操作记录到 BinLog 中。</li></ul></li><li><strong>BinLog 数据传输与中继</strong>： <ul><li>BinLog Dump 线程检测 BinLog 变化后，从指定位置读取内容，并推送给从服务器的 I/O 线程（基于拉取模式，允许从库管理同步进度和处理延迟）。</li><li>I/O 线程接收数据后，写入从服务器的 <strong>中继日志（Relay Log）</strong>。</li></ul></li><li><strong>日志重放与数据应用</strong>：SQL 线程持续读取 Relay Log 内容，解析为 SQL 操作，并应用到从服务器的数据表中，确保数据同步。</li></ol><img src="'+r+'" alt="主从复制-20250830171158147" width="750" style="display:block;margin:auto;"><h2 id="复制方式" tabindex="-1"><a class="header-anchor" href="#复制方式"><span>复制方式</span></a></h2><p>MySQL 支持多种复制方式，以平衡数据一致性和性能：</p><ul><li><strong>异步复制（默认方式）</strong>：主库执行完事务后立即返回客户端，不等待从库完成同步。 <ul><li><strong>缺点</strong>：主库故障时可能导致数据丢失（未同步的变更在从库升级为主库后缺失）。</li><li><strong>适用场景</strong>：高性能需求但对数据一致性要求较低的环境。</li></ul></li><li><strong>全同步复制</strong>：主库执行事务后，等待所有从库完成数据同步才返回客户端。 <ul><li><strong>缺点</strong>：性能显著下降（尤其从库数量多时，延迟增加）。</li><li><strong>优点</strong>：数据安全性最高，确保零丢失。</li></ul></li><li><strong>半同步复制</strong>：主库执行事务后，等待至少一个从库确认接收事件（无需等待所有从库完成执行），再返回客户端。 <ul><li><strong>优点</strong>：平衡安全性和性能（减少数据丢失风险，同时避免全同步的高延迟）。</li><li><strong>适用场景</strong>：对数据一致性有中等要求的环境。</li></ul></li></ul>',8)]))}const c=i(s,[["render",a]]),d=JSON.parse('{"path":"/notes/interview/ca2g9ycx/","title":"主从复制","lang":"zh-CN","frontmatter":{"title":"主从复制","createTime":"2025/08/30 16:49:10","permalink":"/notes/interview/ca2g9ycx/"},"readingTime":{"minutes":2.36,"words":707},"git":{"createdTime":1756719850000,"updatedTime":1757065358000,"contributors":[{"name":"dead_summer","username":"","email":"2941325451@qq.com","commits":3,"avatar":"https://gravatar.com/avatar/d7f172441d823f01ad688f425860dbe76a31ea11c9936176bbd8c14670a619f8?d=retro"}]},"filePathRelative":"notes/八股文自救指南/MySQL/主从复制.md","headers":[]}');export{c as comp,d as data};
