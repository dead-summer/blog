import{a as i,c as a,b as e,o as n}from"./app-CAzY0Upz.js";const l={};function h(t,s){return n(),a("div",null,s[0]||(s[0]=[e(`<p>在 Spring Boot 中进行属性绑定时，有时会遇到属性命名不一致的情况。为了代码规范，开发者可能会使用驼峰命名法，例如将 <code>datasource</code> 修改为 <code>dataSource</code>。本节将深入探讨 Spring Boot 的宽松绑定（或称松散绑定）机制，理解其原理和使用限制。</p><h2 id="_1-宽松绑定的概念" tabindex="-1"><a class="header-anchor" href="#_1-宽松绑定的概念"><span>1. 宽松绑定的概念</span></a></h2><p>宽松绑定是 Spring Boot 为了提升开发体验而引入的一种特性。它允许配置文件中的属性名与 Java 代码中的属性名在格式上具有一定的灵活性，从而减少因命名不匹配而导致的问题。</p><p>例如，在 <code>ServerConfig</code> 类中，<code>ipAddress</code> 属性可以使用多种命名方式在 YAML 配置文件中进行绑定：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Component</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Data</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">ConfigurationProperties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">servers</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> ServerConfig</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    private</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> String</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ipAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以与下面的配置属性名规则全兼容</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">servers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  ipAddress</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.0.2</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">       # 驼峰模式</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  ip_address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.0.2</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 下划线模式</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  ip-address</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.0.2</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 烤肉串模式</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  IP_ADDRESS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 192.168.0.2</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 常量模式</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上四种命名方式都可以成功匹配到 <code>ipAddress</code> 属性。</p><h2 id="_2-宽松绑定的匹配原理" tabindex="-1"><a class="header-anchor" href="#_2-宽松绑定的匹配原理"><span>2. 宽松绑定的匹配原理</span></a></h2><p>Spring Boot 在进行属性匹配时，会先将配置中的名称去除中划线和下划线，然后忽略大小写，再与 Java 代码中的属性名进行忽略大小写的等值匹配。以上述 <code>ipAddress</code> 为例，无论使用 <code>ipAddress</code>、<code>ip_address</code>、<code>ip-address</code> 还是 <code>IP_ADDRESS</code>，经过处理后都变为 <code>ipaddress</code>，与 Java 代码中的 <code>ipAddress</code> 忽略大小写后的结果一致，因此可以成功匹配。</p><p>尽管 Spring Boot 允许使用多种命名方式，但官方推荐使用烤肉串模式（kebab-case），即使用中划线分隔的命名方式。</p><h2 id="_3-configurationproperties-的前缀命名规范" tabindex="-1"><a class="header-anchor" href="#_3-configurationproperties-的前缀命名规范"><span>3. <code>@ConfigurationProperties</code> 的前缀命名规范</span></a></h2><p>在使用 <code>@ConfigurationProperties</code> 注解时，前缀的命名也需要遵循一定的规范。例如，如果将前缀设置为 <code>dataSource</code>，如下：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Bean</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">ConfigurationProperties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">dataSource</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DruidDataSource </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">datasource</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    DruidDataSource</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ds</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> DruidDataSource</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ds</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可能会遇到以下错误：</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Configuration property name </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&#39;dataSource&#39; is not valid:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    Invalid characters: </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&#39;S&#39;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    Bean: datasource</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    Reason: Canonical names should be </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">kebab</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">case</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&#39;-&#39; separated), lowercase alpha-numeric characters and must start with a letter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Action:</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Modify </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&#39;dataSource&#39; so that it conforms to the canonical names requirements.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>错误信息表明，规范的名称应为烤肉串模式，即使用 <code>-</code> 分隔，使用小写字母数字字符，且必须以字母开头。因此，前缀应该使用 <code>data-source</code> 这样的形式：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">Bean</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">@</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">ConfigurationProperties</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">data-source</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DruidDataSource </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">datasource</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    DruidDataSource</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> ds</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> DruidDataSource</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ds</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-value-注解的限制" tabindex="-1"><a class="header-anchor" href="#_4-value-注解的限制"><span>4. <code>@Value</code> 注解的限制</span></a></h2><p>需要注意的是，宽松绑定规则仅对使用 <code>@ConfigurationProperties</code> 注解进行属性绑定时有效，对使用 <code>@Value</code> 注解进行属性映射无效。</p>`,20)]))}const k=i(l,[["render",h]]),p=JSON.parse('{"path":"/notes/HMSpringBoot/ejcvjsmd/","title":"2-2.宽松绑定（松散绑定）","lang":"zh-CN","frontmatter":{"title":"2-2.宽松绑定（松散绑定）","createTime":"2025/06/24 11:19:47","permalink":"/notes/HMSpringBoot/ejcvjsmd/"},"readingTime":{"minutes":2.26,"words":679},"git":{"createdTime":1752578290000,"updatedTime":1752578290000,"contributors":[{"name":"dead_summer","username":"","email":"2941325451@qq.com","commits":1,"avatar":"https://gravatar.com/avatar/d7f172441d823f01ad688f425860dbe76a31ea11c9936176bbd8c14670a619f8?d=retro"}]},"filePathRelative":"notes/黑马程序员SpringBoot/3.开发实用篇/2.配置高级/2-2.宽松绑定（松散绑定）.md","headers":[]}');export{k as comp,p as data};
